import React from "react";
import { useParams } from "react-router-dom";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { getPatientById } from "@/lib/api";
import PatientOverview from "@/components/patients/PatientOverview";
import MedicalHistory from "@/components/patients/MedicalHistory";
import RestorativeChart from "@/components/patients/RestorativeChart";
import PerioChart from "@/components/patients/PerioChart";
import PatientNotes from "@/components/patients/notes/PatientNotes";
import XrayViewer from "@/components/patients/XrayViewer";
import InsuranceDetails from "@/components/patients/InsuranceDetails";
import FinanceSummary from "@/components/patients/FinanceSummary";
import AIHub from "@/components/patients/AIHub";

const PatientProfilePage = () => {
  const { id } = useParams();
  const [patient, setPatient] = React.useState(null);

  React.useEffect(() => {
    const fetchData = async () => {
      const result = await getPatientById(id);
      setPatient(result);
    };
    fetchData();
  }, [id]);

  if (!patient) return <div className="p-4">Loading patient data...</div>;

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-4">
        Patient Profile: {patient.firstName} {patient.lastName}
      </h1>
      <Tabs defaultValue="overview">
        <TabsList>
          <TabsTrigger value="overview">Overview</TabsTrigger>
          <TabsTrigger value="medical">Medical History</TabsTrigger>
          <TabsTrigger value="restorative">Restorative Chart</TabsTrigger>
          <TabsTrigger value="perio">Perio Chart</TabsTrigger>
          <TabsTrigger value="xrays">X-rays</TabsTrigger>
          <TabsTrigger value="ai">AI Hub</TabsTrigger>
          <TabsTrigger value="insurance">Insurance</TabsTrigger>
          <TabsTrigger value="finance">Finances</TabsTrigger>
          <TabsTrigger value="notes">Notes</TabsTrigger>
        </TabsList>

        <TabsContent value="overview">
          <PatientOverview patient={patient} />
        </TabsContent>
        <TabsContent value="medical">
          <MedicalHistory patient={patient} />
        </TabsContent>
        <TabsContent value="restorative">
          <RestorativeChart patient={patient} />
        </TabsContent>
        <TabsContent value="perio">
          <PerioChart patient={patient} />
        </TabsContent>
        <TabsContent value="xrays">
          <XrayViewer patientId={id} />
        </TabsContent>
        <TabsContent value="ai">
          <AIHub patientId={id} />
        </TabsContent>
        <TabsContent value="insurance">
          <InsuranceDetails patient={patient} />
        </TabsContent>
        <TabsContent value="finance">
          <FinanceSummary patient={patient} />
        </TabsContent>
        <TabsContent value="notes">
          <PatientNotes patientId={id} />
        </TabsContent>
      </Tabs>
    </div>
  );
};

export default PatientProfilePage;
